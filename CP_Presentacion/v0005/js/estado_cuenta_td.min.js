function iniciarDataTable(){tabla=objTabla.DataTable({pageLength:500,lengthMenu:[[500,1e3,2e3,-1],["500 Registros","1000 Registros","2000 Registros","Todos"]],dom:"Bfrtip",buttons:[{extend:"pageLength"},{extend:"csvHtml5",text:"CSV",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9]},title:function(){return nombreReporte}},{extend:"excelHtml5",text:"EXCEL",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9]},title:function(){return nombreReporte},sheetName:"Estados de Cuenta"}],language:{url:"bower_components/datatables-buttons/json/spanish.json",buttons:{pageLength:{_:"MOSTRAR %d REGISTROS","-1":"TODOS"}}},fnDrawCallback:function(){var n=objTabla.DataTable();n.data().length===0?n.buttons(".dt-button").disable():n.buttons(".dt-button").enable()},ordering:!1,bDestroy:!0,bDeferRender:!0,paging:!0,scrollY:$(document).height()-550+"px",scrollCollapse:!0,scroller:!0,bSort:!1,autoWidth:!1,responsive:!0,aoColumns:[{sWidth:"50px",sClass:"textoCentrado"},{sWidth:"100px",sClass:"textoCentrado"},null,null,null,null,{sClass:"textoCentrado"},{sClass:"textoCentrado"},{sClass:"textoCentrado"},null,{bSortable:!1,sWidth:"40px"}]})}function eventosBotonClic(){$("#btnAgregar1").on("click",function(n){var t,i,r;n.preventDefault();t=$("#txtBuscarAsociado").val();t!==""&&(i=0,r=$("#txtBuscar").val()==="IDENTIFICACIÓN"?tabla.rows().column(1).data().toArray():tabla.rows().column(0).data().toArray(),i=jQuery.inArray(t,r),i===-1?EjecutarBusquedaAsociado():tabla.data().any()&&Alerta("mensajeAlerta","El Asociado ya existe en la Tabla","warning",2e3))});$("#txtBuscarAsociado").on("keydown",function(n){var i=$("#txtBuscarAsociado").val(),r,t,u;i!==""&&(r=n.which,r===13&&(t=0,u=$("#txtBuscar").val()==="IDENTIFICACIÓN"?tabla.rows().column(1).data().toArray():tabla.rows().column(0).data().toArray(),t=jQuery.inArray(i,u),t===-1?EjecutarBusquedaAsociado():tabla.data().any()&&Alerta("mensajeAlerta","El Asociado ya existe en la Tabla!","warning",2e3)))});$("#btnAgregar2").on("click",function(n){n.preventDefault();dialogoProgreso.show('Cargando Asociados <span class="glyphicon glyphicon-hourglass"><\/span>');animacion=dialogoProgreso.animate();objTabla.dataTable().fnClearTable();EjecutarBusquedaMasiva()});$("#btnLimpiarTabla").on("click",function(n){n.preventDefault();objTabla.dataTable().fnClearTable()});$(document).on("click",".btn-delete",function(n){n.preventDefault();var t=$("#tbl_asociados").DataTable(),i=$(this).parent().parent()[0];t.row(i).remove().draw()});$(document).on("click",".btn-enviar",function(n){var u,f;n.preventDefault();var o=$(this).parent().parent()[0],t=objTabla.fnGetData($(o)),s=parseInt(t[0]),e=t[1],i=t[2],r=t[6],h=t[9],c=t[4];r===0?(u="El asociado <b>"+e+" - "+i+"<\/b> no tiene un Número de Contrato válido. <b>Contrato = "+r.toString()+"<\/b>",f="CONTRATO NO ES VÁLIDO",mensajeConfirm(u,f,"material","red","fa-warning")):(u=' <form action="" class="formName"> <div class="form-group"> <p> Se enviará el estado de cuenta del asociado seleccionado al correo que aparece registrado en <b> PSBANKER <\/b>, si lo requiere puede cambiar la dirección de correo.<\/br> <b class="text-danger">( El cambio de correo NO afecta los datos de PSBANKER )<\/b>.<\/p><\/br> <div style="padding-left: 170px; text-align: left;"> <b> Contrato: <\/b><b class="text-danger">'+r+" <\/b><\/br>  <b> Cédula: <\/b>"+e+"<br> <b> Nombre: <\/b>"+i+"<br> <b> Institución: <\/b>"+c+'<br> <b> Correo: <\/b> <input style="width:300px;" type="email" id="emailAsociado" value="'+h+'"/><\/div><\/br> <\/div> <\/form>',f="Envío de Estado de Cuenta",tema="material",tipo="blue",icono="fa-envelope",tituloConfirmacion="Enviar",mensajeConfirma="Está seguro que desea enviar el estado de cuenta del asociado <b>"+i+"<\/b> al correo ",tituloCancel="Envío Cancelado",mensajeCancel="El envío há sido <b> Cancelado<\/b >.",mensajeEnvio(u,f,tema,tipo,icono,tituloConfirmacion,mensajeConfirma,tituloCancel,mensajeCancel,s,e,i,r,gl_fec_corte))});$("#btnModalGenerar").on("click",function(){for(var r=$("#tbl_asociados").DataTable(),t=r.columns([0,1,6]).data(),i=[],n=0;n<t[0].length;n++)t[2][n]!==0&&i.push({cod_cliente:t[0][n],identificacion:t[1][n],num_contrato:t[2][n]});cantidadRegistrosTD=i.length;$("#modalUbicacion").modal("hide");cantidadRegistrosTD>0?(ruta=$("#ddlDisco").val()+"Estados\\"+login+"\\"+$("#txtDirectorio").val(),GenerarEstados(i)):(mensajeAlerta="No hay registros de Estados de Cuenta con contratos validos para procesar!",tipoMsj="blue",mensajeConfirm(mensajeAlerta,"ESTADOS DE CUENTA","material",tipoMsj,"fa-envelope"))});$("#txtDirectorio").on("input",function(){$("#txtDirectorio").val().includes(nombreDirectorio)?ruta=$("#ddlDisco").val()+"Estados\\"+login+"\\"+$("#txtDirectorio").val():$("#txtDirectorio").val(nombreDirectorio)});$("#chkUltimoCodCliente").on("ifChanged",function(){$("#chkUltimoCodCliente").is(":checked")?$("#txtUltimoCodCliente").prop("disabled",!1):$("#txtUltimoCodCliente").prop("disabled",!0)})}function EjecutarBusquedaAsociado(){var t=$("#txtBuscarAsociado").val(),n={};conEmail=$("#conEmail").is(":checked")?"S":"N";conTarjeta=$("#conTarjeta").is(":checked")?"S":"N";conContrato=$("#conContrato").is(":checked")?"S":"N";$("#txtBuscar").val()==="IDENTIFICACIÓN"?(n.identificacion=t,n.codigo="0"):(n.codigo=t,n.identificacion="0");n.cod_provincia="0";n.cod_canton="0";n.cod_distrito="0";n.cod_centro="0";n.cod_institucion="0";n.cod_lugar="0";n.con_email=conEmail;buscarAsociados(n,1)}function buscarAsociados(n,t){var i,r;tipo=t;clic||(clic=!0,i=n.identificacion==="0"?n.codigo:n.identificacion,n.ult_cod_cliente_gen=$("#chkUltimoCodCliente").is(":checked")&&$("#txtUltimoCodCliente").val()!==""?parseInt($("#txtUltimoCodCliente").val()):0,n.tipo_consulta="AHORRO-VISTA",r=JSON.stringify(n),$.ajax({type:"POST",url:ApiUrl+"/CargarAsociados",data:r,contentType:"application/json; charset=utf-8",error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaUrl);animacion!==undefined&&setTimeout(function(){dialogoProgreso.hide();dialogoProgreso.stopAnimate(animacion)},500)},success:function(n){var t,r;if(n.Exito===0)Alerta("mensajeAlerta",n.Mensaje,"danger",3e3);else if(n.Data.length===0)if(tipo===1){var u="",f="",e="";$("#conEmail").is(":checked")&&(u=" [Con Email]");$("#conTarjeta").is(":checked")&&(e=" [Con Tarjeta]");$("#conContrato").is(":checked")&&(f=" [Con Contrato]");t="info";r="No se encontró el asociado: "+i+", filtros activos: "+u+e+f;mensajeToast2(t,"<h4>"+r+"<\/h4>","top-end",5e3)}else t="info",r="No se encontraron asociados que concuerden con los filtros ingresados",mensajeToast2(t,"<h4>"+r+"<\/h4>","top-end",5e3);else agregarFilasDTAsociados(n.Data)}}).done(function(){animacion!==undefined&&setTimeout(function(){dialogoProgreso.hide();dialogoProgreso.stopAnimate(animacion)},500);clic=!1}))}function agregarFilasDTAsociados(n){var u=[],r=[],f=[],t=[],e,o,i;if(r=conTarjeta==="S"?jQuery.grep(n,function(n){return n.tarjeta!=="NO TIENE"},!1):n,f=conContrato==="S"?jQuery.grep(r,function(n){return n.num_contrato!==0},!1):r,t=f,t.length===0)e="info",o="No se encontraron asociados que concuerden con los filtros ingresados",mensajeToast2(e,"<h4>"+o+"<\/h4>","top-end",5e3);else{for(i=0;i<t.length;i++)u.push([t[i].codigo,t[i].identificacion,t[i].nombre,t[i].centro,t[i].institucion,t[i].lugar_trabajo,t[i].num_contrato,t[i].tarjeta,t[i].cuenta_iban,t[i].email,'<button type="button" id="'+t[i].identificacion+"-"+t[i].num_contrato+'" value="'+t[i].email+'" style="margin: 2px;" title="Enviar Email" class="btn btn-primary btn-enviar btn_datatable btn-xs"><i class="fa fa-envelope-o" aria-hidden="true"><\/i><\/button><button type="button" value="Eliminar" style="margin: 2px;" title="Eliminar" class="btn btn-danger btn-delete btn_datatable btn-xs"><i class="fa fa-minus" aria-hidden="true"><\/i><\/button>']);objTabla.dataTable().fnAddData(u)}}function mensajeEnvio(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var p;p=n.length>500?"large":"medium";f=f===""?"Aceptar":f;e=e===""?"Está seguro de realizar esta acción ?":e;var w=r===""?"green":r,b=u===""?"fa-check-circle":u,y=i===""?"material":i;$.confirm({theme:y,title:t,content:n,columnClass:p,icon:"fa "+b,type:w,draggable:!0,dragWindowGap:0,animation:"scale",closeAnimation:"zoom",animationBounce:2.5,escapeKey:"cerrar",backgroundDismiss:!1,buttons:{confirm:{text:f,btnClass:"btn-primary",action:function(){if(emailEntrada=$("#emailAsociado").val(),emailEntrada)if(validarEmail(emailEntrada))$.confirm({theme:y,columnClass:"medium",type:w,title:"Confirmación de Envío",content:e+'<b class="text-danger">'+emailEntrada+"<\/b>.",icon:"fa fa-question-circle",animation:"scale",closeAnimation:"zoom",buttons:{confirm:{text:"Confirmar",btnClass:"btn-primary",action:function(){EnviarEstadoCuenta(h,c,l,a,emailEntrada,v,rutaEnvios)}},cancel:{text:"CANCELAR",btnClass:"btn-red",action:function(){mensajeConfirm(s,o,y,"blue","fa-warning")}}}});else return mensajeAlerta="Ingrese una dirección de correo valida!",t="Email Incorrecto",mensajeConfirm(mensajeAlerta,t,"material","red","fa-warning"),!1;else return $("#emailAsociado").focus(),!1}},cerrar:{text:"Cerrar",btnClass:"btn-red"}}})}function EnviarEstadoCuenta(n,t,i,r,u,f,e){var h="Estado de cuenta <b>Enviado<\/b> al correo: ",s="ENVIO DE ESTADO DE CUENTA",o={};o.tipo_consulta="AHORRO-VISTA";o.cod_cliente=n;o.identificacion=t;o.nombre=i;o.num_contrato=r;o.email=u;o.fec_corte=f;o.ruta_genera=e;o.id_usuario=cod_usuario;data=JSON.stringify(o);$.ajax({type:"POST",url:ApiUrl+"/EnviarEstadoCuentaTD",data:data,contentType:"application/json; charset=utf-8",error:function(n,t,i){MensajeAlerta="Error: "+n.status+"<br>"+n.responseJSON.Message;"\n"+i;mensajeError(MensajeAlerta,paginaUrl);setTimeout(function(){window.location="./Login.aspx"},3e3)},success:function(n){n.Exito===1?(mensajeAlerta=h+'<b class="text-danger">'+n.Data.email+'<\/b>.<\/br><\/br><div style="padding-left: 20px; text-align:left;"><b>Asociado: <\/b>'+n.Data.identificacion+" - "+n.Data.nombre+'<\/br><b>Contrato:  <\/b><b class="text-danger">'+n.Data.num_contrato+"<\/b><\/br><b>Ruta:  <\/b>"+n.Data.ruta_genera+"<\/br><b>Archivo:  <\/b>"+n.Data.archivo+"<\/div>",mensajeConfirm(mensajeAlerta,s,"material","green","fa-envelope")):mensajeConfirm(n.Mensaje,s,"material","red","fa-warning")}})}function EjecutarBusquedaMasiva(){var n={};conEmail=$("#conEmail").is(":checked")?"S":"N";conTarjeta=$("#conTarjeta").is(":checked")?"S":"N";conContrato=$("#conContrato").is(":checked")?"S":"N";n.cod_provincia=$("#ddlProvincia").val();n.cod_canton=$("#ddlCanton").val();n.cod_distrito=$("#ddlDistrito").val();n.cod_centro=$("#ddlCentro").val();n.cod_institucion=$("#ddlInstitucion").val();n.cod_lugar=$("#ddlLugarTrabajo").val();n.con_email=conEmail;n.codigo="0";n.identificacion="0";buscarAsociados(n,2)}function GenerarEstados(n){var s=$("#txtFormato").val(),t,r,u,e,f,i,o;if(borrarDirectorio=$("#borrarDirectorio").is(":checked")?"S":"N",t={},t.fec_corte=gl_fec_corte,t.ruta=ruta,t.formato=s,t.borrar_directorio=borrarDirectorio,t.id_usuario=cod_usuario,r=get_browser_info(),t.navegador=r.name+" - "+r.version,cantidadRegistrosTD>=100)for(u=cantidadRegistrosTD>=3e3?11:5,e=parseInt(cantidadRegistrosTD/u),progresoGeneracion(cantidadRegistrosTD,u+1),f=separarArray(n,e),cantidadLotesTD=f.length,i=0;i<cantidadLotesTD;i++)o=f[i],t.lista_contratos=o,t.num_lote=i+1,EjecutarGeneracionEstados(t);else cantidadLotesTD=1,progresoGeneracion(cantidadRegistrosTD,1),t.lista_contratos=n,t.num_lote=1,EjecutarGeneracionEstados(t)}function EjecutarGeneracionEstados(n){var t=JSON.stringify(n);$.ajax({type:"POST",url:ApiUrl+"/GenerarEstadoCuentaTD",data:t,contentType:"application/json; charset=utf-8",dataType:"json",error:function(n,t,i){MensajeAlerta="Error: "+n.status+"<br>"+n.responseJSON.ExceptionMessage+"\n"+n.responseText;"\n"+i;dialogoProgreso.progress(99);dialogoProgreso.hide();mensajeError(MensajeAlerta,"ESTADO DE CUENTA MASIVO");setTimeout(function(){window.location="./Login.aspx"},1e4)},success:function(n){if(n.Exito===1){totalRegistrosTDProcesados+=n.Data;totalLotesTDProcesados+=1;var i=calculoPorcentaje(cantidadRegistrosTD,totalRegistrosTDProcesados),t="Registros procesados : ( "+totalRegistrosTDProcesados.toString()+" de "+cantidadRegistrosTD.toString()+" ) Progreso: "+i.toString()+"%";t=t+"<\/br><\/br>LOTE #"+totalLotesTDProcesados.toString()+" "+n.Mensaje.toString();dialogoProgreso.mensaje(t);dialogoProgreso.progress(i);mensajeAlertaToast="LOTE #"+totalLotesTDProcesados.toString()+" FINALIZADO. REGISTROS: "+n.Data;tipoIcono="info"}else mensajeAlertaToast="LOTE #"+totalLotesTDProcesados.toString()+" FINALIZADO CON ERRORES. REGISTROS: "+n.Data+" , ERROR: "+n.Mensaje.toString(),mensajeAlerta,tipoIcono="error";mensajeAlerta+=mensajeAlertaToast+"<\/br>";mensajeToast(tipoIcono,mensajeAlertaToast);cantidadLotesTD===totalLotesTDProcesados&&(cantidadRegistrosTD===totalRegistrosTDProcesados?(mensajeAlerta="Proceso finalizado con exito. Registros procesados: "+totalRegistrosTDProcesados+" de "+cantidadRegistrosTD,tipoMsj="green"):(mensajeAlerta="Proceso finalizado con errores. Registros procesados: "+totalRegistrosTDProcesados+" de "+cantidadRegistrosTD+"<\/br><\/br>"+mensajeAlerta,tipoMsj="red"),setTimeout(function(){dialogoProgreso.hide();mensajeToast(tipoIcono,mensajeAlerta);mensajeConfirm(mensajeAlerta,"Estados de Cuenta","material",tipoMsj,"fa-envelope");mensajeAlerta="";cantidadRegistrosTD=0;totalRegistrosTDProcesados=0;totalLotesTDProcesados=0;cantidadLotesTD=0},5e3))}})}function getFechaCorte(){Swal.fire({icon:"info",title:"FECHA DE CORTE",html:'Elija la fecha de corte del estado de cuenta Ahorro Vista, puede ser Histórico o Actual.<\/br><\/br><div class= "input-group date"> <div class="input-group-addon"><i class="fa fa-calendar"><\/i><\/div><input type="text" class="form-control pull-right datepicker textoCentrado" id="datepicker"><\/div>',timer:0,footer:"<a href>Fecha de Corte para el reporte de Ahorro Vista.<\/a>",confirmButtonText:'<i class="fa fa-thumbs-up"><\/i> GUARDAR',focusConfirm:!0,showCancelButton:!1,showCloseButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,cancelButtonColor:"#d33",cancelButtonText:'<i class="fa fa-thumbs-down"><\/i> CANCELAR',backdrop:!0,toast:!1,timerProgressBar:!1,onOpen:function(){$("#datepicker").datepicker({format:"mm-yyyy",showButtonPanel:!0,viewMode:"months",minViewMode:"months",orientation:"bottom",autoclose:!0})},preConfirm:function(){if($("#datepicker").val()==="")return $("#datepicker").focus(),!1}}).then(function(n){if(n.value&&$("#datepicker").val()!==""){var t=$("#datepicker").datepicker("getDate"),i=new Date(t.getFullYear(),t.getMonth()+1,0);if(gl_fec_corte=$.datepicker.formatDate("dd/mm/yy",i),Swal.fire("GUARDADO CON EXITO",'<h5>Fecha de Corte de Ahorro Vista <\/br><b class="text-danger">'+gl_fec_corte+"<\/b><\/h5>","success"),$("#infoTitulo").remove(),!$("#infoTitulo").length){$("<button id='infoTitulo' class='dataTables_info dt-button buttons-html5' style='border: darkred solid 1px !important;' type='button'>FECHA DE CORTE: <b style='font-size: large;'>"+gl_fec_corte+"<\/h4><\/button>").appendTo("#tbl_asociados_wrapper .dt-buttons");$("#infoTitulo").on("click",function(){getFechaCorte()})}}})}function progresoGeneracion(n,t){var i=t>1?" lotes":" lote",r=n>1?" registros":" registro",u="Procesando <b>"+n+"<\/b> "+r+" en <b>"+t+"<\/b>"+i+' <span class="glyphicon glyphicon-hourglass"><\/span>';dialogoProgreso.show(u,{dialogSize:"m",progressType:"info"});dialogoProgreso.progress(1)}function inicializarPreCarga(){$("input").iCheck({checkboxClass:"icheckbox_futurico",radioClass:"iradio_futurico",increaseArea:"25%"});nombreDirectorio=formatDate(new Date);$("#txtBuscar").val("IDENTIFICACIÓN");$("#ckUbicacion").on("ifChecked",function(){$("#ckUbicacion").is(":checked")&&$("#txtDirectorio").removeAttr("disabled")});$("#ckUbicacion").on("ifUnchecked",function(){$("#txtDirectorio").val();$("#txtDirectorio").attr("disabled","disabled");$("#txtDirectorio").trigger("change")});$("#ddlDisco, #txtDirectorio ").on("change paste keyup",function(){$("#lbRuta").text(" "+$("#ddlDisco").val()+"Estados\\"+login+"\\"+$("#txtDirectorio").val())});$("#modalUbicacion").on("show.bs.modal",function(){$("#txtDirectorio").val(nombreDirectorio);$("#lbRuta").text(" "+$("#ddlDisco").val()+"Estados\\"+login+"\\"+$("#txtDirectorio").val());$("#txtFormato").val("PDF")});$("#btnFormato").on("click","li a",function(){$("#txtFormato").val($(this).text())});$("#btnModalGenerar").on("click",function(){$("#txtFormato").removeAttr("disabled")});$("#btnBuscar").on("click","li a",function(){$("#txtBuscar").val($(this).text())})}function CargarCantones(){if($("#ddlCanton").attr("disabled","disabled"),$("#ddlDistrito").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>'),$("#ddlDistrito").attr("disabled","disabled"),$("#ddlProvincia").val()==="0")$("#ddlCanton").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>'),$("#ddlDistrito").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>');else{$("#ddlCanton").empty().append('<option selected="selected" value="0">Cargando...<\/option>');var n={};n.provinciaId=$("#ddlProvincia").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaUrl+"/CargarCantones",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){LlenarControl(n.d,$("#ddlCanton"))},error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaUrl)}})}}function CargarDistritos(){if($("#ddlDistrito").attr("disabled","disabled"),$("#ddlCanton").val()==="0")$("#ddlDistrito").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>');else{$("#ddlDistrito").empty().append('<option selected="selected" value="0">Cargando...<\/option>');var n={};n.provinciaId=$("#ddlProvincia").val();n.cantonId=$("#ddlCanton").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaUrl+"/CargarDistritos",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){LlenarControl(n.d,$("#ddlDistrito"))},error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaUrl)}})}}function CargarInstituciones(){if($("#ddlInstitucion").attr("disabled","disabled"),$("#ddlLugarTrabajo").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>'),$("#ddlLugarTrabajo").attr("disabled","disabled"),$("#ddlCentro").val()==="0")$("#ddlInstitucion").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>'),$("#ddlLugarTrabajo").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>');else{$("#ddlInstitucion").empty().append('<option selected="selected" value="0">Cargando...<\/option>');var n={};n.centroId=$("#ddlCentro").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaUrl+"/CargarInstituciones",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){LlenarControl(n.d,$("#ddlInstitucion"))},error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaUrl)}})}}function CargarLugaresTrabajo(){if($("#ddlLugarTrabajo").attr("disabled","disabled"),$("#ddlInstitucion").val()==="0")$("#ddlLugarTrabajo").empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>');else{$("#ddlLugarTrabajo").empty().append('<option selected="selected" value="0">Cargando...<\/option>');var n={};n.centroId=$("#ddlCentro").val();n.institucionId=$("#ddlInstitucion").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaUrl+"/CargarLugaresTrabajo",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){LlenarControl(n.d,$("#ddlLugarTrabajo"))},error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaUrl)}})}}function LlenarControl(n,t){n.length>0?(t.removeAttr("disabled"),t.empty().append('<option selected="selected" value="0">Seleccione un valor<\/option>'),t.attr("id")==="ddlCanton"?$.each(n,function(){t.append($("<option><\/option>").val(this.cod_canton).html(this.nombre))}):t.attr("id")==="ddlDistrito"?$.each(n,function(){t.append($("<option><\/option>").val(this.cod_distrito).html(this.nombre))}):t.attr("id")==="ddlInstitucion"?$.each(n,function(){t.append($("<option><\/option>").val(this.cod_institucion).html(this.nombre))}):$.each(n,function(){t.append($("<option><\/option>").val(this.cod_lugar_trabajo).html(this.nombre))})):t.empty().append('<option selected="selected" value="0">No existen registros!<option>')}var paginaUrl="Estados_de_Cuenta_TD.aspx",ApiUrl="http://OMEGA:8087/api/EstadoCuentaTD",tabla,data,objTabla=$("#tbl_asociados"),inicio,ruta,rutaEnvios,animacion,MsjTerminarEstados,tipoMsj,conEmail,conTarjeta,conContrato,borrarDirectorio,nombreReporte="Estados de Cuenta T.D - Lista de Asociados",gl_fec_corte="",emailEntrada,mensajeAlerta="",tipo,clic=!1,cantidadRegistrosTD=0,totalRegistrosTDProcesados=0,totalLotesTDProcesados=0,cantidadLotesTD=0,nombreDirectorio;$(document).ready(function(){inicializarPreCarga();getFechaCorte();nombreDirectorio=formatDate(new Date)+"_TD";login=$("#Login").val().trim();rutaEnvios=$("#ddlDisco").val()+"Estados\\"+login+"\\"+formatDate(new Date)+"_ENVIOS_TD";iniciarDataTable();eventosBotonClic()});